<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>TH's Notes - markdown</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">TH's Notes </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/markdown.html">markdown</a></li>
                    <li><a href="/category/review.html">Review</a></li>
                </ul></nav>
        </header><!-- /#banner -->

                <section id="content" class="body">
                    <ol id="posts-list" class="hfeed" start="9">
            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-rails-zhong-shi-yong-ajax.html" rel="bookmark"
                           title="Permalink to "在 Rails 中使用 Ajax"">"在 Rails 中使用 Ajax"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-20T10:23:37+08:00">
                Published: 四 20 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>假設有一個投票功能，每次按文章左側的上下箭頭可以表示贊成或反對，
但我們不希望使用者每次投票時，瀏覽器都必須重新載入頁面，
這時候可以使用 <a href="http://zh.wikipedia.org/wiki/AJAX">Ajax</a> 技術來實現。</p>
<p><img src="https://farm8.staticflickr.com/7518/15646273670_3d1f14d6e4_b.jpg"></p>
<p><img src="https://farm8.staticflickr.com/7564/15807472506_af32ac663c_b.jpg"></p>
<h3>設定 routes</h3>
<p>對應上面的範例，我們先設定 config/routes.rb，
因為投票動作本身沒有 view， 所以將動作設定為 post</p>
<div class="highlight"><pre><span class="n">resources</span> <span class="ss">:posts</span> <span class="k">do</span>
  <span class="n">member</span> <span class="k">do</span>
    <span class="n">post</span> <span class="ss">:vote</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>


<h3>設定 view</h3>
<p>接著開啟 html 檔案 app/views/posts/_post.html.erb
加入 <code>remote: true</code>，來呼叫 javascript 動作</p>
<div class="highlight"><pre><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;post_vote_error_ ...</span></pre></div>
                <a class="readmore" href="/zai-rails-zhong-shi-yong-ajax.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/she-ding-polymorphic-association.html" rel="bookmark"
                           title="Permalink to "設定 polymorphic association"">"設定 polymorphic association"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-15T10:15:50+08:00">
                Published: 六 15 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>假設我們有個布告版，上面可以張貼文章和留言，
如果我們希望新增一個功能讓使用者可以對文章或留言進行投票，
這時候可以透過 polymorphic association 來描述
Vote 和 Post 以及 Comment 三個物件模型之間的關係。</p>
<h3>新增 Table</h3>
<p>首先，在資料庫中新增一個 votes table 來儲存投票資訊;
在 votes 中，
<code>voteable_type</code> 和 <code>voteable_id</code> 分別代表被投票物件的名稱和 id。
新增完成後，查看 db/schema.rb 如下
{% codeblock db/schema.rb %}
  create_table "votes", force: true do |t|
    t.boolean  "vote"
    t.integer  "user_id ...</p>
                <a class="readmore" href="/she-ding-polymorphic-association.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/bu-shu-zhuan-an-dao-heroku.html" rel="bookmark"
                           title="Permalink to "部署專案到 Heroku"">"部署專案到 Heroku"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-13T12:43:54+08:00">
                Published: 四 13 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p><a href="https://www.heroku.com">Heroku</a> 是個相當受歡迎的雲端平台，
為開發者建構了網站運行所需要的環境，
原則上，使用者只要將自己的應用程式部署上去便可直接運行;
目前，它還提供了免費試用的方案，相當適合學生練習實作。
而使用方法簡介如下</p>
<ul>
<li>
<p>先到 Keroku 官網進行<a href="https://id.heroku.com/login">註冊</a></p>
</li>
<li>
<p>註冊後，登入官網然後下載 Heroku toolbelt 並且安裝</p>
</li>
<li>
<p>打開終端機，執行 <code>heroku login</code> 來登入使用者資訊並上傳 public ssh key</p>
</li>
<li>
<p>在專案下，執行 <code>heroku create</code></p>
</li>
</ul>
<div class="highlight"><pre><span class="nv">$ </span>heroku create
Creating agile-sea-7701... <span class="k">done</span>, stack is cedar-14
https://agile-sea-7701.herokuapp.com/ <span class="p">|</span> git@heroku.com:agile-sea-7701.git
Git remote heroku ...</pre></div>
                <a class="readmore" href="/bu-shu-zhuan-an-dao-heroku.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-rails-shi-zuo-yan-zheng-ji-zhi.html" rel="bookmark"
                           title="Permalink to "在 Rails 實作驗證機制"">"在 Rails 實作驗證機制"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-09T11:37:17+08:00">
                Published: 日 09 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>在網路應用中，使用者驗證是一項常見的重要功能，
雖然使用現成的 gem 
(例如 <a href="https://github.com/plataformatec/devise">Devise</a>)，
可以快速實現出功能原型，但是卻會因為對套件內部架構的不熟悉，
而無法輕易修改或擴充新功能;
所以，這裡將敘述如何單純地使用 Rails 的內建功能來實作驗證機制，
希望讓讀者對其中的工作原理有透徹的認識。</p>
<h3>安裝 <code>bcrypt-ruby</code></h3>
<p>為了支援密碼驗證，我們先在 Gemfile 中加入 </p>
<div class="highlight"><pre>gem &#39;bcrypt-ruby&#39;, &#39;3.0.1&#39;
</pre></div>


<p>然後執行 bundle 進行套件安裝。</p>
<h3>設定資料庫</h3>
<p>假設我們的使用者資料表名稱為 users，
先在 users 中新增一個 password_digest 的字串欄位，
然後在 db/schema 確認如下</p>
<div class="highlight"><pre>  <span class="n">create_table</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="ss">force</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
    <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="s2">&quot;username&quot;</span>
    <span class="n">t ...</span></pre></div>
                <a class="readmore" href="/zai-rails-shi-zuo-yan-zheng-ji-zhi.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/vim-de-chang-yong-zhi-ling.html" rel="bookmark"
                           title="Permalink to "Vim 的常用指令"">"Vim 的常用指令"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-03T21:04:21+08:00">
                Published: 一 03 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>在編程領域中，
<a href="http://zh.wikipedia.org/wiki/%E7%BC%96%E8%BE%91%E5%99%A8%E4%B9%8B%E6%88%98">編輯器之戰</a>的兩位主角 <a href="http://zh.wikipedia.org/wiki/Vi">Vi</a> 和 
<a href="http://zh.wikipedia.org/wiki/Emacs">Emacs</a> 經歷幾十年的歲月後，
直到現在依然擁有許多信徒; 
而隨著時間的過去，Vi 的功能不斷地被增強，最後演化出目前受歡迎的 <a href="http://zh.wikipedia.org/wiki/Vim">Vim</a> ，
關於 Vim 的詳細手冊可查詢<a href="http://vimdoc.sourceforge.net/htmldoc/usr_toc.html">官方文件</a>，這裡僅列出常用的一些指令。</p>
<h3>環境設定</h3>
<ul>
<li>~/.vimrc: 環境設定檔</li>
<li>~/.vim: Vim 專屬的資料夾</li>
</ul>
<h3>內建指令</h3>
<ul>
<li><code>vi file_name</code> 開啟檔案</li>
<li><code>Ecs</code> 進入命令模式</li>
<li><code>:w</code> 存檔</li>
<li><code>:q</code> 離開</li>
<li><code>:q!</code> 強制離開(不須先存檔)</li>
<li><code>:e file_name</code> 編輯其它檔案</li>
<li><code>x</code> 刪除一個字元</li>
<li><code>i</code> 在游標所在處開始輸入文字</li>
<li><code>a</code> 從下個字元開始輸入文字</li>
<li><code>p</code> 將暫存區資料貼上</li>
<li><code>yy</code> 拷貝游標所在的那一行 ...</li></ul>
                <a class="readmore" href="/vim-de-chang-yong-zhi-ling.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-google-chrome-zhong-zi-ding-kuai-jie-jian.html" rel="bookmark"
                           title="Permalink to "在 Google Chrome 中自定快捷鍵"">"在 Google Chrome 中自定快捷鍵"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-01T11:43:15+08:00">
                Published: 六 01 11月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>在開發網站時，
我們常常需要使用 <a href="http://www.google.com/chrome/">Google Chrome</a> 來協助測試，這裡將介紹如何透過安裝 plugin 來自定快捷鍵，以提高工作效率。</p>
<p>先開啓 Google Chrome ，然後安裝 <a href="https://chrome.google.com/webstore/detail/shortkeys/logpjaacgmcbpdkdchjiaagddngobkck">Shortkeys</a>;
安裝完成後，即可開始在 Shortkeys 中自定所需的快捷鍵。
設定路徑: Chrome -&gt; Preferences -&gt; Extensions -&gt; Shortkeys -&gt; Options。 </p>
<p>設定畫面如下
<img src="https://farm4.staticflickr.com/3948/15678482785_10249cd29b_b.jpg"></p>
<p>在這個範例中，分別自定了 <code>command+shift+right</code> 和 <code>command+shift+left</code> 
來選擇下一個和上一個瀏覽分頁。</p>
                <a class="readmore" href="/zai-google-chrome-zhong-zi-ding-kuai-jie-jian.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-rails-zhong-she-ding-duo-dui-duo-guan-lian-xing.html" rel="bookmark"
                           title="Permalink to "在 Rails 中設定多對多關聯性"">"在 Rails 中設定多對多關聯性"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-10-29T12:50:12+08:00">
                Published: 三 29 10月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>這裡將介紹如何在 Rails 中透過 <code>has_many through:</code> 來設定多對多關聯性。
而一對多關聯性的介紹可參考先前的<a href="/blog/2014/10/29/1-m-association-in-rails/">文章</a>。</p>
<p>假設我們有兩種模型 Post 和 Category，
倘若每個 post 可擁有多個 categories，
而每個 Category 也可以擁有多個 posts，
於是 Post 和 Category 之間就存在著多對多的關係;
以下將敘述如何實作這樣的關聯性。</p>
<h3>建立 tables</h3>
<p>首先我們需要在資料庫中新增三個 tables，
分別是 posts、categories 和 post_categories;
在 post_categories 中應包含 post_id 和 category_id 這兩個 column。
(如果不清楚如何新增 table 可參考<a href="/blog/2014/10/29/1-m-association-in-rails/">這裡</a>)</p>
<p>新增完 tables 後 ...</p>
                <a class="readmore" href="/zai-rails-zhong-she-ding-duo-dui-duo-guan-lian-xing.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-rails-zhong-she-ding-yi-dui-duo-guan-lian-xing.html" rel="bookmark"
                           title="Permalink to "在 Rails 中設定一對多關聯性"">"在 Rails 中設定一對多關聯性"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-10-29T10:48:07+08:00">
                Published: 三 29 10月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>物件與物件之間的關係,可以是一對一、一對多或多對多;
這裡將介紹如何在 Rails 中設定一對多關聯性。</p>
<p>假設我們現在想設計一個網站讓使用者可以在上面發表文章，
由於每位使用者可以發表多篇文章，
於是使用者和文章之間就存在著一對多的關係;
以下將敘述如何實作這樣的關聯性。</p>
<h3>建立 migration</h3>
<p>首先， 為 users table 建立 migration 檔案</p>
<div class="highlight"><pre>rails generate migration create_users
</pre></div>


<p>執行命令後，將產生對應的檔案(數字部分代表建立的時間)</p>
<div class="highlight"><pre>db/migrate/20141028055510_create_users.rb
</pre></div>


<p>編輯此檔案的內容，指定 table 包含一個 username 的 column，如下</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">CreateUsers</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">create_table</span> <span class="ss">:users</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span> 
      <span class="n">t</span><span class="o">.</span><span class="n">string ...</span></pre></div>
                <a class="readmore" href="/zai-rails-zhong-she-ding-yi-dui-duo-guan-lian-xing.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-rails-zhong-she-ding-routes.html" rel="bookmark"
                           title="Permalink to "在 Rails 中設定 routes"">"在 Rails 中設定 routes"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-10-29T09:45:19+08:00">
                Published: 三 29 10月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>在 Rails 中，當伺服器接受到 http request 時將會根據路由中的設定，
來決定這個 request 將會送往 controller 的哪個 action 進行處理;
這裡將介紹如何設定路由的路徑表。</p>
<p>在 config/routes.rb 可使用 <code>root to:</code> 來設定當使用者存取網站根目錄時的伺服器將會將 request 導向哪裡;假設我們設定如下</p>
<div class="highlight"><pre><span class="no">PostitTemplate</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">&#39;posts#index&#39;</span>
<span class="k">end</span>
</pre></div>


<p>接著使用 <code>bundle exec rake routes</code> 來查詢路徑表</p>
<div class="highlight"><pre><span class="nv">$ </span>bundle <span class="nb">exec </span>rake routes
Prefix Verb URI Pattern ...</pre></div>
                <a class="readmore" href="/zai-rails-zhong-she-ding-routes.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/zai-bu-luo-ge-zhong-jia-ru-flickr-tu-pian.html" rel="bookmark"
                           title="Permalink to "在部落格中加入 Flickr 圖片"">"在部落格中加入 Flickr 圖片"</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-10-29T07:54:02+08:00">
                Published: 三 29 10月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew-tsai.html">Andrew Tsai</a>
        </address>
<p>In <a href="/category/markdown.html">markdown</a>.</p>

</footer><!-- /.post-info -->                <p>編寫部落格時，適當地加入圖片可以吸引更多讀者，同時也提高了文章的可讀性。
隨著雲端相簿的流行，有許多人會傾向將圖片貯存位置和部落格平台獨立開來;
這樣的話，一方面可以集中圖片的管理，另一方面，如果日後想更換寫作平台，
就不需要去煩惱圖片的轉移工作。 </p>
<p><a href="https://www.flickr.com/">Flickr</a> 是目前相當受歡迎的免費雲端相簿，
這篇文章將說明如何用它將圖片加入到你的部落格中。</p>
<ul>
<li>
<p>首先，請先到 <a href="https://www.flickr.com/">Flickr</a> 上面註冊，
然後在裡面新增一份相簿，接著上傳一張測試圖片並加入到新建立的相簿中。</p>
</li>
<li>
<p>先選擇圖片，接著點選 "Share this photo"，然後指定希望的圖片大小，
這時候會產生對應的 HTML code。</p>
</li>
</ul>
<p><img src="https://farm8.staticflickr.com/7561/15652040191_aec65ccfbc_b.jpg"></p>
<ul>
<li>在 HTML code 中 <code>&lt;img src=</code> 後面的部分就是圖片的網址</li>
</ul>
<div class="highlight"><pre>&lt;img src=&quot;https://farm8.staticflickr.com/7563/15655510442_e9803f8335_b.jpg&quot; width=&quot;1024&quot; height=&quot;768&quot; alt=&quot;FF-12 ...</pre></div>
                <a class="readmore" href="/zai-bu-luo-ge-zhong-jia-ru-flickr-tu-pian.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
        <a href="/category/markdown.html">&laquo;</a>
    Page 2 / 3
        <a href="/category/markdown3.html">&raquo;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>